<ng-container *ngIf="cart$ | async as cart">
  <ng-container *ngIf="entries$ | async as entries">
    <div *ngIf="cart.totalItems > 0" class="cart-details-wrapper">
      <ng-container *cxFeatureLevel="'4.2'">
        <cx-cart-validation-warnings></cx-cart-validation-warnings>
      </ng-container>

      <h4 class="cx-total">
        {{ 'cartDetails.cartName' | cxTranslate: { code: cart.code } }}
      </h4>

      <cx-promotions
        [promotions]="
          (cart.appliedOrderPromotions || []).concat(
            cart.potentialOrderPromotions || []
          )
        "
      ></cx-promotions>

      <cx-cart-item-list
        [items]="entries"
        [cartIsLoading]="!(cartLoaded$ | async)"
        [promotionLocation]="promotionLocation"
        [options]="{
          isSaveForLater: false,
          optionalBtn: saveForLaterBtn
        }"
      ></cx-cart-item-list>
    </div>
    <div *ngIf="cart.totalItems > 0" class="empty-cart-wrapper">
      <button
        *ngIf="!clearMode"
        (click)="clear()"
        class="btn btn-block btn-action empty-cart-btn"
        type="button"
      >
        {{ 'clearCart.clearCart' | cxTranslate }}
      </button>
      <div *ngIf="clearMode" class="row cx-clear-cart">
        <span class="clear-cart-msg">
          {{ 'clearCart.areYouSureToClearCart' | cxTranslate }}
        </span>
        <div class="col-md-6">
          <button
            class="btn btn-block btn-secondary"
            (click)="cancelClearCart()"
            type="button"
          >
            {{ 'common.cancel' | cxTranslate }}
          </button>
        </div>
        <div class="col-md-6">
          <button
            type="button"
            class="btn btn-block btn-primary"
            (click)="clear()"
          >
            {{ 'common.clear' | cxTranslate }}
          </button>
        </div>
      </div>
    </div>
  </ng-container>
</ng-container>

<ng-template let-ctx #saveForLaterBtn>
  <div
    *ngIf="selectiveCartEnabled"
    class="col-md-3 col-lg-3 col-xl-3 cx-sfl-btn"
  >
    <button
      class="link cx-action-link"
      [disabled]="ctx.loading"
      (click)="saveForLater(ctx.item)"
      type="button"
    >
      {{ 'saveForLaterItems.saveForLater' | cxTranslate }}
    </button>
  </div>
</ng-template>
